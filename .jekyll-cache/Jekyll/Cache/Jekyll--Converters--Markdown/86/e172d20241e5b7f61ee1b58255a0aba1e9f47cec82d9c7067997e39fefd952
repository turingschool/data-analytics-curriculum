I"8<p>In this lesson, you will explore an application with a large dataset. Production databases are often very large and present new challenges that we don’t often face in our development environments. We will explore various parts of the application that are problematic, try to understand why they are problematic, and discuss some potential solutions to these problems. At the end of this lesson, you will find more resources to help implement those solutions.</p>

<h2 id="learning-goals">Learning Goals</h2>

<ul>
  <li>Gain exposure to some common problems with large production databases</li>
  <li>Familiarize yourself with some optimization strategies</li>
</ul>

<h2 id="set-up">Set Up</h2>

<p>First, follow the instructions in the readme to set up <a href="https://github.com/turingschool-examples/optimization">this Repo</a>.</p>

<h2 id="rails-server">Rails Server</h2>

<p>As you go through these activities, use the output from <code class="highlighter-rouge">rails server</code> to analyze performance. The <code class="highlighter-rouge">rails server</code> gives you some very important information. Pay close attention to:</p>

<ul>
  <li>The last line of output for each request. This will tell you the total load time, as well a breakdown of what contributed to the load time (ActiveRecord and Views)</li>
  <li>The SQl queries executed for each request. Pay attention to both the number of queries, as well as the time for each query.</li>
</ul>

<h2 id="activity-1">Activity 1</h2>

<ol>
  <li>Run <code class="highlighter-rouge">rails server</code> and visit <code class="highlighter-rouge">localhost:3000</code></li>
  <li>Log in as an admin
    <ul>
      <li>email: <code class="highlighter-rouge">admin@email.com</code></li>
      <li>password: <code class="highlighter-rouge">password</code></li>
    </ul>
  </li>
  <li>In the nav bar, click on <code class="highlighter-rouge">Users</code>. Alternatively, visit <code class="highlighter-rouge">/admin/users</code></li>
  <li>Click on <code class="highlighter-rouge">Send Promotional Email</code></li>
</ol>

<p>Then, discuss the following questions:</p>

<ul>
  <li>What happens when you click <code class="highlighter-rouge">Send Promotional Email</code>?</li>
  <li>Why does it take so long?</li>
  <li>How many users exist in the database? How long would this take if the number of users increased 10x? 100x? 1000x?</li>
  <li>At a high level, how could you make this operation less painful?</li>
</ul>

<h2 id="activity-2">Activity 2</h2>

<ol>
  <li>Stay logged in as an admin</li>
  <li>In the nav bar, click on <code class="highlighter-rouge">Dashboard</code>. Alternatively, visit <code class="highlighter-rouge">/admin</code></li>
  <li>Look at the output from your <code class="highlighter-rouge">rails server</code>.
    <ul>
      <li>Refresh the page a couple of times and see if the output differs</li>
      <li>Do you see anything that says <code class="highlighter-rouge">CACHE</code>? If so, restart your <code class="highlighter-rouge">rails server</code> and refresh the page. Did anything change? Why or why not?</li>
    </ul>
  </li>
</ol>

<p>Then, discuss the following questions:</p>

<ul>
  <li>Does this operation take a long time? Is it painful for the user?</li>
  <li>How many orders exist in the database? How long would this take if the number of orders increased 10x? 100x? 1000x?</li>
  <li>Look at the output from <code class="highlighter-rouge">rails server</code>. What is wrong with it? Find the exact line of code that is causing this issue?</li>
  <li>At a high level, how could you make this operation less painful?</li>
</ul>

<h2 id="activity-3">Activity 3</h2>

<ol>
  <li>In the nav bar, click on <code class="highlighter-rouge">Items</code></li>
</ol>

<p>Then, discuss the following questions:</p>

<ul>
  <li>What is contributing most to this page load time? How do you know?</li>
  <li>For the information displayed on this page, which pieces of data need to be as accurate as possible? Are there any that can be “close enough”?</li>
  <li>At a high level, how could you make this operation less painful?</li>
</ul>

<h2 id="additional-resources">Additional Resources</h2>

<ul>
  <li><a href="./caching_in_rails">Caching in Rails</a></li>
  <li><a href="./performance_dojo">Optimization Dojo</a></li>
  <li><a href="./background_workers">Background Workers</a></li>
</ul>
:ET