I"î<h2 id="learning-goals">Learning Goals</h2>

<ul>
  <li>Use Rails controller tests to test JSON apis</li>
  <li>Use ActiveModel::Serializers to customize JSON responses</li>
</ul>

<h2 id="structure">Structure</h2>

<ul>
  <li>25 - Warm Up and Discussion</li>
  <li>5 - Break</li>
  <li>25 - API TDD Codealong (Articles#show)</li>
  <li>5 - Break</li>
  <li>25 - Your Turn - students add Articles#index</li>
</ul>

<h2 id="warm-up">Warm-Up</h2>

<p><strong>JSON Serialization in Rails</strong></p>

<ul>
  <li><code class="highlighter-rouge">ActiveRecord#to_json</code> â€“ Railsâ€™ default serialization technique â€“ What are its limitations?</li>
  <li>Alternatives â€“ ActiveModel::Serializers, Jbuilder, Rabl, Draper â€“
what do these do?</li>
  <li>ActiveModel::Serializers â€“ Advantages: Easy Ember integeration; ease
of use; maintains â€œobject-orientedâ€ approach to generating JSON</li>
</ul>

<p><strong>Testing Rails APIs</strong></p>

<ul>
  <li>Integration tests vs. Controller tests â€“ pros / cons (controller
tests lighter, less â€œfull-stackâ€; integration tests generally more
robust, but also slower and more complicated)</li>
  <li>needs for testing a JSON API â€“ no â€œUIâ€ <em>per se</em>, so we have less need
for a full â€œintegrationâ€ test</li>
</ul>

<h2 id="tutorial">Tutorial</h2>

<p>Letâ€™s get familiar with these techniques by TDDâ€™ing a simple API for the
Blogger project.</p>

<ol>
  <li>Project setup â€“ you and blogger are old friends by now; clone the
project, bundle, setup, etc:</li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/JumpstartLab/blogger_advanced.git
cd blogger_advanced
bundle
rake db:drop db:create db:migrate db:seed
</code></pre></div></div>

<p>Letâ€™s work through adding a simple API to expose article data.</p>

<p>For now our API can be read-only, so letâ€™s add a simple <code class="highlighter-rouge">#show</code>
and <code class="highlighter-rouge">#index</code> endpoint.</p>

<p>Weâ€™ll serve both endpoints under the <code class="highlighter-rouge">api/v1/articles</code> route
namespace.</p>

<p>For the Articles#show, endpoint, weâ€™ll retrieve the article
by its id, and expose these pieces of information:</p>

<ul>
  <li>id</li>
  <li>title</li>
  <li>body</li>
  <li>Authorâ€™s name</li>
</ul>

<p><strong>Code-A-Long</strong> â€“ follow along as we TDD an implementation
of the Article#show endpoint to expose these data. Weâ€™ll use
controller tests to verify the behavior of our API and
ActiveModel::Serializers to generate the JSON.</p>

<p>cheatsheet</p>

<p><strong>intstalling activemodels serializers</strong>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem 'active_model_serializers'
rails g serializer article
</code></pre></div></div>

<p><strong>Your Turn</strong> â€“ following the example we just did, add an additional
endpoint for Articles#index</p>

<p>Remember that this should be served at the <code class="highlighter-rouge">api/v1/articles</code> route.</p>

<p>For the index, expose the following data for each article:</p>

<ul>
  <li>id</li>
  <li>title</li>
  <li>tag names (remember that articles have many tags via taggings)</li>
  <li>number of comments</li>
</ul>

<p>(Hint: you can always add a second serializer for this endpoint if
necessary)</p>

<p><strong>If we get hereâ€¦</strong> â€“ If we finish all that, letâ€™s look and endpoints
that accept or modify data. For starters, letâ€™s add an endpoint to
create an article.</p>
:ET